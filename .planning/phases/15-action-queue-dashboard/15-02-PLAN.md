---
phase: 15-action-queue-dashboard
plan: 02
type: execute
wave: 2
depends_on: ['15-01']
files_modified:
  - app/admin/page.tsx
autonomous: true

must_haves:
  truths:
    - 'Dashboard shows grouped action items: hypotheses to review, drafts to approve, calls/tasks due, replies to handle'
    - 'Each action item links directly to the page where admin takes action (prospect detail for hypotheses, outreach page for drafts/tasks/replies)'
    - 'Dashboard shows count badges per action type with visual urgency for overdue items'
    - 'Empty state is shown when no actions are pending'
  artifacts:
    - path: 'app/admin/page.tsx'
      provides: 'Action queue dashboard page'
      contains: 'getActionQueue'
  key_links:
    - from: 'app/admin/page.tsx'
      to: 'server/routers/admin.ts'
      via: 'api.admin.getActionQueue.useQuery()'
      pattern: "getActionQueue\\.useQuery"
    - from: 'app/admin/page.tsx'
      to: '/admin/prospects/[id]'
      via: 'Link href for hypothesis and task items'
      pattern: 'admin/prospects/'
    - from: 'app/admin/page.tsx'
      to: '/admin/outreach'
      via: 'Link href for draft and reply items'
      pattern: 'admin/outreach'
---

<objective>
Replace the current dashboard page with an action queue hub showing all pending admin decisions grouped by type, with count badges, urgency indicators, and direct links to act on each item.

Purpose: The user's workflow is queue-first — open dashboard, see what needs decisions, act. The current dashboard shows KPI vanity metrics but doesn't surface actionable items. This replacement makes the dashboard the central "what do I do next?" hub.

Output: Rewritten `app/admin/page.tsx`
</objective>

<execution_context>
@/home/klarifai/.claude/get-shit-done/workflows/execute-plan.md
@/home/klarifai/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

@.planning/phases/15-action-queue-dashboard/15-01-SUMMARY.md
@app/admin/page.tsx
@app/admin/layout.tsx
@app/admin/campaigns/[id]/page.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Replace dashboard with action queue hub</name>
  <files>app/admin/page.tsx</files>
  <action>
Rewrite `app/admin/page.tsx` completely. Keep `'use client'` and the same import pattern (`api` from `@/components/providers`, `Link` from `next/link`, `cn` from `@/lib/utils`).

**Data fetching:**

- Call `api.admin.getActionQueue.useQuery()` as the sole data source
- Do NOT call getDashboardStats — no vanity KPIs, no smoke data, no fake trends

**Layout structure (top to bottom):**

1. **Header row** — "Dashboard" as h1 (text-3xl font-black text-[#040026] tracking-tighter). Below it: date in Dutch locale format (`new Date().toLocaleDateString('nl-NL', { weekday: 'long', day: 'numeric', month: 'long' })`). Right side: if `counts.total > 0`, show a badge: `{counts.total} items need attention` in a rounded pill (bg-amber-50 text-amber-700 text-xs font-bold px-3 py-1 rounded-full).

2. **Action type count strip** — Horizontal row of 4 compact cards (grid grid-cols-2 lg:grid-cols-4 gap-3). Each card is a glass-card (NOT glass-card-hover) with p-4, showing:
   - Icon + label + count
   - Cards:
     a. "Review" (Lightbulb icon from lucide) — `counts.hypotheses` — links to `#hypotheses` anchor
     b. "Approve" (Mail icon) — `counts.drafts` — links to `#drafts` anchor
     c. "Tasks" (Phone icon) — `counts.tasks` with `counts.overdueTasks > 0` showing a red sub-badge `{overdueTasks} overdue` — links to `#tasks` anchor
     d. "Replies" (MessageSquare icon) — `counts.replies` — links to `#replies` anchor
   - Count is text-2xl font-black. Label is text-[10px] font-bold uppercase tracking-widest text-slate-400.
   - If count is 0, card has opacity-50.
   - Overdue indicator: if overdueTasks > 0, show a small red dot (w-2 h-2 rounded-full bg-red-500 animate-pulse) next to the Tasks count.

3. **Action queue sections** — Four sections, each rendered only if items exist for that type. Each section:
   - Has an `id` attribute for anchor linking (id="hypotheses", id="drafts", id="tasks", id="replies")
   - Section heading: h2 with icon + label + count badge (bg-slate-100 rounded-full px-2.5 py-0.5 text-xs font-bold text-slate-500)
   - Items as a list of clickable rows

   **Section: Hypotheses to Review** (type === 'hypothesis')
   - Heading: Lightbulb icon + "Hypotheses to Review" + count badge
   - Each row: glass-card p-4 mb-2 hover:border-[#EBCB4B]/30 transition-all. Contains:
     - Left: Company name (font-bold text-sm text-[#040026]), hypothesis title below (text-xs text-slate-500 truncate max-w-md)
     - Right: time ago (text-[10px] text-slate-400), and a Link wrapping the row to `/admin/prospects/${item.prospectId}#analysis` (deep link to analysis section)
   - Wrap the entire row in a `<Link>` component

   **Section: Drafts to Approve** (type === 'draft')
   - Heading: Mail icon + "Drafts to Approve" + count badge
   - Each row same pattern: company name + draft title (subject), time ago
   - Link: `/admin/outreach` (drafts live on the "queue" tab — outreach page doesn't support ?tab= deep links yet, so bare URL is correct)

   **Section: Tasks Due** (type === 'task')
   - Heading: Phone icon + "Tasks Due" + count badge
   - Each row: company name + task title + channel icon (Phone for call, Linkedin for linkedin, MessageCircle for whatsapp, Mail for email)
   - If `item.urgency === 'overdue'`: add red left border (border-l-4 border-red-500) and "OVERDUE" text badge (text-[9px] font-bold text-red-600 bg-red-50 px-1.5 py-0.5 rounded)
   - If `item.dueAt`: show due date (text-[10px] text-slate-400)
   - Link: `/admin/outreach` (tasks live on the "tasks" tab — no deep link support yet)

   **Section: Replies to Handle** (type === 'reply')
   - Heading: MessageSquare icon + "Replies to Handle" + count badge
   - Each row: company name + reply subject, time ago
   - Link: `/admin/outreach` (replies live on the "replies" tab — no deep link support yet)

4. **Empty state** — If `counts.total === 0`: show a centered glass-card p-12 with a check-circle icon (CheckCircle2 from lucide, w-12 h-12 text-emerald-400), "All caught up!" heading (text-xl font-bold text-[#040026]), and "No pending decisions right now." subtext (text-sm text-slate-400).

**Loading state:** Show skeleton with 4 count cards (animate-pulse bg-slate-100 rounded-2xl h-20) + 6 row skeletons (bg-slate-50 rounded-xl h-14).

**Error state:** Same as current pattern — glass-card p-12 text-center text-red-500.

**Time ago helper:** Add a small inline helper `function timeAgo(date: Date | string): string` that returns "Xm ago", "Xh ago", "Xd ago" based on difference from now. Keep it simple: < 60min = minutes, < 24h = hours, else days. Use for all row timestamps.

**Style notes:**

- Use glass-card class for cards (never combine with dark bg Tailwind classes)
- Use CSS variable colors via Tailwind (text-[#040026], text-[#EBCB4B]) — consistent with existing pages
- Keep the page under 300 lines — extract helper components inline (ActionSection, ActionRow, CountCard) as const arrow functions before the default export
- Import only needed lucide icons: Lightbulb, Mail, Phone, MessageSquare, MessageCircle, Linkedin, CheckCircle2
  </action>
  <verify>
  Run `npm run check` — must pass. Visually: navigate to /admin in browser — dashboard should show action queue with count strip and grouped sections.
  </verify>
  <done>
  Dashboard at /admin shows: (1) count strip with per-type totals and urgency indicators, (2) grouped action items with direct links, (3) empty state when nothing is pending.
  </done>
  </task>

</tasks>

<verification>
1. `npm run check` passes with no errors
2. Dashboard renders action queue with four section types
3. Each item links to the correct action page
4. Overdue tasks show red urgency indicator
5. Empty state displays when no actions pending
6. Page stays under 300 lines
</verification>

<success_criteria>

- Dashboard shows unified action queue with hypotheses, drafts, tasks, and replies
- Each item links to its action page (prospect detail for hypotheses, outreach for drafts/tasks/replies)
- Count badges show per-type totals with overdue indicator
- Empty state shown when no pending actions
- Page renders without errors and passes type checks
  </success_criteria>

<output>
After completion, create `.planning/phases/15-action-queue-dashboard/15-02-SUMMARY.md`
</output>
