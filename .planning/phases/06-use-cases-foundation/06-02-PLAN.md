---
phase: 06-use-cases-foundation
plan: 02
type: execute
wave: 2
depends_on: ['06-01']
files_modified:
  - app/admin/use-cases/page.tsx
  - app/admin/layout.tsx
autonomous: true

must_haves:
  truths:
    - 'Admin can see a list of all use cases in a dedicated Use Cases tab'
    - 'Admin can create a new use case with title, summary, category, outcomes, tags, case study refs'
    - 'Admin can edit an existing use case inline or via form'
    - 'Admin can soft-delete (deactivate) a use case'
    - 'Admin can trigger Obsidian import and see created/skipped counts'
    - 'Use Cases nav item appears in the Intelligence group in the sidebar'
  artifacts:
    - path: 'app/admin/use-cases/page.tsx'
      provides: 'Use Cases admin page with list, create, edit, delete, import'
      min_lines: 150
    - path: 'app/admin/layout.tsx'
      provides: 'Nav item for Use Cases'
      contains: 'use-cases'
  key_links:
    - from: 'app/admin/use-cases/page.tsx'
      to: 'api.useCases'
      via: 'tRPC React Query hooks'
      pattern: "api\\.useCases\\."
    - from: 'app/admin/layout.tsx'
      to: '/admin/use-cases'
      via: 'navItems href'
      pattern: 'use-cases'
---

<objective>
Build the admin UI page for managing use cases and add the navigation entry.

Purpose: Enables admin to create, edit, delete, and import use cases entirely in-app, fulfilling UCASE-01 and UCASE-02 requirements. No file access or deployments needed to manage the proof catalog.

Output: A fully functional Use Cases admin page at `/admin/use-cases` and a sidebar nav item.
</objective>

<execution_context>
@/home/klarifai/.claude/get-shit-done/workflows/execute-plan.md
@/home/klarifai/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/06-use-cases-foundation/06-RESEARCH.md
@.planning/phases/06-use-cases-foundation/06-01-SUMMARY.md

@app/admin/layout.tsx (nav structure, navItems array, icon imports)
@app/admin/campaigns/page.tsx (reference pattern: 'use client', api hooks, inline form state, Tailwind classes)
@app/admin/research/page.tsx (secondary pattern reference)
@app/globals.css (glass-card, btn-pill-primary, btn-pill-secondary class definitions)
@components/providers.tsx (api import for tRPC)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Use Cases admin page with list, CRUD, and import</name>
  <files>app/admin/use-cases/page.tsx</files>
  <action>
Create `app/admin/use-cases/page.tsx` as a `'use client'` page. Follow the exact pattern established in `app/admin/campaigns/page.tsx`:

1. **Imports:** `'use client'` directive, `useState` from react, `api` from `@/components/providers`, icons from `lucide-react` (use `BookOpen`, `Plus`, `Pencil`, `Trash2`, `Upload`, `Loader2`, `Tag`, `ExternalLink`).

2. **Data fetching:** `api.useCases.list.useQuery()` for the list. `api.useUtils()` for cache invalidation.

3. **Mutations:** Set up mutations for create, update, delete, importFromObsidian. Each mutation's `onSuccess` calls `utils.useCases.list.invalidate()`.

4. **State:** Use `useState` for:
   - `editingId: string | null` — which use case is being edited
   - `showCreateForm: boolean` — toggle create form visibility
   - Form fields: `title, summary, category, outcomes (comma-separated string), tags (comma-separated string), caseStudyRefs (comma-separated string), isShipped (boolean), externalUrl (string)`

5. **Layout:**
   - Page header: "Use Cases" title with description "Service catalog — evidence-backed offerings for proof matching"
   - Action buttons row: "New Use Case" button (opens create form), "Import from Obsidian" button (calls importFromObsidian mutation, shows loading state with Loader2 spinner, shows toast/alert with created/skipped counts on success)
   - List of use case cards, each showing:
     - Title (bold), category badge, isShipped/isActive status badges
     - Summary text
     - Tags displayed as pill badges (inline, small, slate background)
     - Outcomes as a bullet list (if any)
     - Case study refs as links (if any)
     - Edit and Delete action buttons
     - Proof match count from `_count.proofMatches`
   - Create/edit form (inline, shown conditionally):
     - Input fields for title, summary, category (text input, not select — categories are free-form)
     - Textarea or multi-line input for outcomes (comma-separated, split on save)
     - Tags input (comma-separated, split on save)
     - Case study refs input (comma-separated, split on save)
     - Checkbox for isShipped
     - Input for externalUrl (optional)
     - Save and Cancel buttons

6. **Styling:** Use existing design tokens from the codebase:
   - Card container: `bg-white rounded-2xl border border-slate-100 p-6 shadow-sm`
   - Page title: `text-3xl font-black tracking-tight text-[#040026]`
   - Input fields: `w-full px-4 py-3 bg-slate-50 border border-slate-200 rounded-xl text-sm focus:outline-none focus:ring-2 focus:ring-[#040026]/5 focus:border-[#040026] transition-all`
   - Primary button: `px-6 py-3 bg-[#040026] text-white rounded-xl font-bold text-sm hover:opacity-90 transition-all`
   - Secondary button: `px-4 py-2 border border-slate-200 rounded-xl text-sm font-medium text-slate-600 hover:bg-slate-50 transition-all`
   - Tag badges: `inline-flex px-2 py-0.5 text-xs font-medium rounded-full bg-slate-100 text-slate-600`
   - Category badge: `inline-flex px-2.5 py-1 text-xs font-bold rounded-lg bg-blue-50 text-blue-700`

7. **Comma-separated array handling:** When saving, split comma-separated strings into arrays: `value.split(',').map(s => s.trim()).filter(Boolean)`. When editing, join arrays back to comma-separated strings for the input.

8. **Loading/empty states:** Show `Loader2` spinner with `animate-spin` while data is loading. Show empty state message when no use cases exist ("No use cases yet. Create one or import from Obsidian.").

9. **Import feedback:** After importFromObsidian mutation succeeds, use `window.alert()` (simple and matches existing patterns) to show `Created ${data.created} use cases, skipped ${data.skipped} duplicates`. If errors array is non-empty, append them.

IMPORTANT: Do NOT use any form library. Use inline `useState` for all form state, exactly like campaigns/page.tsx does.
</action>
<verify>

1. `npm run check` passes (TypeScript compiles, lint passes)
2. File exists at `app/admin/use-cases/page.tsx` and is a valid React component
3. Page uses `api.useCases.list.useQuery()` and all four mutations
   </verify>
   <done>
   Use Cases page renders a list of use cases with create/edit/delete forms and an import button. All tRPC hooks are wired. Styling follows existing admin page patterns. `npm run check` passes.
   </done>
   </task>

<task type="auto">
  <name>Task 2: Add Use Cases nav item to admin sidebar</name>
  <files>app/admin/layout.tsx</files>
  <action>
In `app/admin/layout.tsx`:

1. Add `BookOpen` to the lucide-react import (add it alphabetically to the existing destructured import).

2. In the `navItems` array inside `AdminShell`, add a new entry to the `'Intelligence'` group's `items` array. Place it as the FIRST item in the Intelligence group (before Research runs) since Use Cases is the foundation for all intelligence:

```typescript
{ href: '/admin/use-cases', label: 'Use Cases', icon: BookOpen },
```

The Intelligence group should now be:

```typescript
{
  group: 'Intelligence', items: [
    { href: '/admin/use-cases', label: 'Use Cases', icon: BookOpen },
    { href: '/admin/research', label: 'Research runs', icon: Beaker },
    { href: '/admin/briefs', label: 'Product Briefs', icon: FileText },
    { href: '/admin/signals', label: 'Signals feed', icon: Zap },
  ]
},
```

  </action>
  <verify>
1. `npm run check` passes
2. `BookOpen` is imported from lucide-react
3. navItems Intelligence group contains `{ href: '/admin/use-cases', ... }`
  </verify>
  <done>
Use Cases nav item appears in the Intelligence section of the admin sidebar, before Research runs. Icon is BookOpen from lucide-react.
  </done>
</task>

</tasks>

<verification>
1. `npm run check` — TypeScript compiles, lint passes
2. Navigate to `/admin/use-cases` in browser — page renders without errors
3. Sidebar shows "Use Cases" link in Intelligence group
4. Create, edit, delete operations work via the form
5. Import button triggers the Obsidian import and shows results
</verification>

<success_criteria>

- Admin can navigate to /admin/use-cases from the sidebar
- Page lists all use cases with title, category, tags, outcomes, status badges
- Create form adds a new use case to the database
- Edit form updates an existing use case
- Delete button soft-deletes (deactivates) a use case
- Import button calls importFromObsidian and shows created/skipped counts
- npm run check passes
  </success_criteria>

<output>
After completion, create `.planning/phases/06-use-cases-foundation/06-02-SUMMARY.md`
</output>
